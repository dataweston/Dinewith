generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  password  String
  salt      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum WaitlistStatus {
  PENDING
  CONTACTED
}

model City {
  id              String          @id @default(cuid())
  name            String
  slug            String          @unique
  stateName       String
  stateSlug       String
  stateCode       String
  headline        String?
  description     String?
  heroCopy        String?
  heroImage       String?
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  waitlistEntries WaitlistEntry[]

  @@index([stateSlug])
}

model WaitlistEntry {
  id        String          @id @default(cuid())
  email     String
  name      String?
  guests    Int?
  notes     String?
  source    String?         @default("city-landing")
  status    WaitlistStatus  @default(PENDING)
  cityId    String
  city      City            @relation(fields: [cityId], references: [id], onDelete: Cascade)
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt

  @@unique([email, cityId])
}
